---
title: "2025 R/Medicine Challenge: Measles Vaccinations and Outbreak Trends"
date: "2025-05-05"
format:
  html:
    toc: true
    toc-depth: 3
    theme: cosmo
    code-fold: true
    code-tools: true
editor: visual
---

```{r setup libraries, include=FALSE}
# Ensure these are installed: install.packages(c("plotly", "dplyr", "readr", "lubridate", "tidyr", "janitor", "scales", "DT"))
packages <- c("plotly", "dplyr", "readr", "lubridate", "tidyr", "janitor", "scales", "DT")
for (package in packages) {
  if (!require(package, character.only=T, quietly=T)) {
    install.packages(package)
    library(package, character.only=T)
  }
}
```

```{r load data}
load_data <- function(url) {
  tryCatch(
    {
      df <- read_csv(url, show_col_types = FALSE) %>%
        janitor::clean_names() # Standardize column names
      message("Successfully loaded and cleaned data from: ", basename(url))
      return(df)
    },
    error = function(e) {
      message("Failed to load data from: ", url)
      message("Error: ", e$message)
      return(NULL)
    }
  )
}

# --- Data URLs ---
base_url <- "https://raw.githubusercontent.com/fbranda/measles/main/"
urls <- list(
  global_coverage = paste0(base_url, "Measles_vaccination_coverage_Global.csv"),
  global_cases = paste0(base_url, "Measles_Global.csv"),
  europe_cases = paste0(base_url, "Measles_Europe.csv"),
  us_coverage_cases = paste0(base_url, "USA/data/all/measles-USA-by-mmr-coverage.csv"),
  us_onset = paste0(base_url, "USA/data/all/measles-USA-by-onset-date.csv"),
  us_year = paste0(base_url, "USA/data/all/measles-USA-by-year.csv"),
  us_age_2025 = paste0(base_url, "USA/data/2025/measles-USA-by-age.csv"),
  us_county_2025 = paste0(base_url, "USA/data/2025/measles-USA-by-county-timeline.csv"),
  us_state_2025 = paste0(base_url, "USA/data/2025/measles-USA-by-state-timeline.csv"),
  us_confirmed_2025 = paste0(base_url, "USA/data/2025/measles-USA-confirmed-cases.csv")
)

#----Load Data----
data <- lapply(urls, load_data)

```

# Introduction

Changing attitudes towards vaccination have led to declining MMR coverage, putting herd immunity at risk. This document explores trends in vaccination, outbreaks using [data](https://github.com/fbranda/measles) from the 2025 R/Medicine Challenge.

# Data Exploration

## 1. Global Measles Vaccination Coverage

```{r global-measles-vaccination-coverage-plot}
coverage_summary <- data$global_coverage %>%
      filter(!is.na(antigen) & !is.na(region)) %>%
      group_by(region, year) %>%
      summarise(avg_coverage = mean(coverage, na.rm = TRUE), .groups = 'drop')
    
    p1_1 <- plot_ly(coverage_summary, x = ~year, y = ~avg_coverage, color = ~region,
                    type = 'scatter', mode = 'lines+markers',
                    text = ~paste("Region:", region, "<br>Year:", year, "<br>Coverage:", round(avg_coverage, 1), "%"),
                    hoverinfo = 'text') %>%
      layout(title = "Avg. Vaccination Coverage by Region", yaxis = list(range = c(0,100), title="Avg Coverage (%)"))
    p1_1
```

## 2. Global Measles Cases

```{r }

```

## 3. European Measles Cases

```{r }

```

## 4. US Measles Cases by Year

```{r }

```

## 5. 2025 US Measles Cases by Age Group

```{r}

```

## 6. Top 10 2025 Measles Cases by US State 

```{r}

```

## 7. Top 10 2025 Measles Cases by US State Counties

```{r}

```

```{}
```

```{}
```

# 4. Exploratory Analysis

```{r }

```

```{r }

```

## 5. Data Deep Dive

```{r }

```

```{r }

```

# Conclusion

This exploratory analysis highlights concerning trends in MMR vaccination and measles resurgence in 2025. Low vaccination coverage correlates strongly with increased outbreak risk. Continued monitoring and policy support are essential to protect public health.
