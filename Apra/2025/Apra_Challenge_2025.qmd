---
title: "Apra Challenge 2025"
format:
  html:
    embed-resources: true
    toc: true
    toc-depth: 3
    theme: cosmo
    code-fold: true
    code-tools: true
editor: visual
---

```{r setup libraries, include=FALSE}
# Load Libraries
packages <- c(
  'ggplot2','tidyverse','plotly','leaflet',
  'shiny','shinyWidgets','shinydashboard',
  'xts','forecast','TTR',
  'DT','lubridate','RColorBrewer','scales','stopwords',
  'tidytext','stringr','wordcloud','wordcloud2',
  'SnowballC','textmineR','topicmodels','textclean','tm'
)
for (package in packages) { 
  if (!require(package, character.only = T, quietly = T)) {
    install.packages(package)
    library(package, character.only = T)
  }
}
```

```{r}
## Load Data
crm <- read_csv("CRM_interacions_table.csv")
gift <- read_csv("gift_transactions_table.csv")
video <- read_csv("video_email_data_table.csv")
constituent <- read_csv("constituent_profiles_table.csv")
```

# Data Exploration

## CRM

CRM Interaction Type

```{r}
#| echo: false
#| message: true
#| warning: true

## CRM Interaction Type
     g <- crm %>%
        group_by(CRM_INTERACTION_TYPE) %>%
        summarise(Total = n()) %>%
        select(CRM_INTERACTION_TYPE, Total) %>%
        ggplot(aes(x = reorder(CRM_INTERACTION_TYPE,Total) ,y = Total))  +
        geom_bar(stat = "identity",width = 0.5, fill='black')  +
        scale_y_continuous(labels = scales::comma) +
        labs(x ="CRM Interaction Type", y = "Count") + coord_flip() +
        theme(legend.text = element_text(size = 12),
              legend.title = element_text(size = 12),
              axis.title = element_text(size = 14),
              axis.text = element_text(size = 12))
      
ggplotly(g)
```

CRM Interaction Over time

Yearly CRM Interaction

```{r}
crm <- crm %>%
        mutate(Year = lubridate::year(INTERACTION_DATE),
               Quarter = lubridate::quarter(INTERACTION_DATE),
               Month = lubridate::month(INTERACTION_DATE, label = TRUE),
               DOW = lubridate::wday(INTERACTION_DATE, label=TRUE))


   g <- ggplot(trend, aes(Year, Total, group=`Gas Type`, colour = `Gas Type`)) + 
      geom_line( size=1) + theme_minimal() +
      labs(x = "Year", y = "Total", color="Gas Type") + 
      scale_y_continuous(labels = comma) +
      theme(legend.text = element_text(size = 10),
            legend.title = element_text(size = 10),
            axis.title = element_text(size = 10),
            axis.text = element_text(size = 10),
            axis.text.x = element_text(angle = 0, hjust = 1))
    
ggplotly(g)
```

Quarterly CRM Interaction

```{r}

```

Monthly CRM Interaction

```{r}

```

```{}
```

Day of Week CRM Interaction

```{}
```

## Gift Overview

```{r}

```

```{r}

```

## Video Overview

```{r}

```

## Constituent Overview

```{r}

```

```{r}

```

# Part 1: The Untapped Potential: Understanding Our Donor Landscape

```{r}

```
